import { makeTbl, fillInNavFooter, genTable, expand } from "./report.js";

// add expand function to game length button
const exp_btn1 = document.getElementById('exp_btn');

// expand1 function expands the first hidden div
function expand1() {
    expand(0)
    return
}

exp_btn1.addEventListener("click", expand1, false);

// add game length stats to the table
const lenDiv = document.getElementById('game-length-table-div');

const gameLenArr = {
    "Tiles Used": [4.0, 6.0, 7.0, 8.0, 9.0, 10.0, 11.0, 12.0, 13.0, 14.0, 15.0, 16.0, 17.0, 18.0, 19.0, 20.0, 21.0, 22.0, 23.0, 24.0, 25.0, 26.0, 27.0, 28.0, 29.0, 30.0, 31.0, 32.0, 33.0, 34.0, 35.0, 36.0, 37.0, 38.0, 39.0, 40.0, 41.0, 42.0, 43.0, 44.0, 45.0, 46.0, 47.0, 48.0, 49.0, 50.0, 51.0, 52.0, 53.0, 54.0, 55.0, 56.0, 57.0, 58.0, 59.0, 60.0, 61.0, 62.0, 63.0, 64.0, 65.0, 66.0, 67.0, 68.0, 69.0, 70.0, 71.0, 72.0, 73.0, 74.0, 75.0, 76.0, 77.0, 78.0, 79.0, 80.0, "Draw"],
    "Occurences": [1.0, 1.0, 1.0, 3.0, 5.0, 10.0, 17.0, 26.0, 36.0, 62.0, 78.0, 112.0, 139.0, 219.0, 271.0, 288.0, 421.0, 471.0, 508.0, 618.0, 690.0, 760.0, 896.0, 904.0, 980.0, 1058.0, 1141.0, 1202.0, 1209.0, 1185.0, 1239.0, 1228.0, 1278.0, 1244.0, 1266.0, 1259.0, 1154.0, 1187.0, 1061.0, 1117.0, 1052.0, 1006.0, 930.0, 825.0, 877.0, 796.0, 705.0, 726.0, 680.0, 573.0, 593.0, 495.0, 510.0, 399.0, 428.0, 372.0, 322.0, 307.0, 292.0, 256.0, 240.0, 231.0, 216.0, 189.0, 158.0, 125.0, 128.0, 128.0, 108.0, 109.0, 74.0, 87.0, 74.0, 64.0, 41.0, 44.0, 495.0],
};

const gameLenTbl = makeTbl(gameLenArr);
gameLenTbl.setAttribute('class', 'resultsTable')
lenDiv.appendChild(gameLenTbl);

// plot data
let x_arr = gameLenArr["Tiles Used"].slice();
let y_arr = gameLenArr["Occurences"].slice();
// Remove the draw entry from both arrays
x_arr = x_arr.splice(0, x_arr.length-1)
y_arr = y_arr.splice(0, y_arr.length-1);

const gameLenArrData = [{
    x: x_arr,
    y: y_arr,
    name: 'Games',
    mode: 'markers',
    type: 'scatter',
}];

const gameLenLayout = {
    xaxis: {range: [0, 84], title: "Tiles Used"},
    yaxis: {range: [0, 1300], title: "Occurences (games)"},
    title: "Games ended for different amount of tiles played",
    font: {
        family: "Ubuntu, monospace",
        size: 16,
    }
};

Plotly.newPlot('game-length-graph', gameLenArrData, gameLenLayout);

// Gamma fit

const gameLenGammaFit = {
    "Tiles Used": [0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0, 11.0, 12.0, 13.0, 14.0, 15.0, 16.0, 17.0, 18.0, 19.0, 20.0, 21.0, 22.0, 23.0, 24.0, 25.0, 26.0, 27.0, 28.0, 29.0, 30.0, 31.0, 32.0, 33.0, 34.0, 35.0, 36.0, 37.0, 38.0, 39.0, 40.0, 41.0, 42.0, 43.0, 44.0, 45.0, 46.0, 47.0, 48.0, 49.0, 50.0, 51.0, 52.0, 53.0, 54.0, 55.0, 56.0, 57.0, 58.0, 59.0, 60.0, 61.0, 62.0, 63.0, 64.0, 65.0, 66.0, 67.0, 68.0, 69.0, 70.0, 71.0, 72.0, 73.0, 74.0, 75.0, 76.0, 77.0, 78.0, 79.0, 80.0],
    "PDF": [0.0, 4.81974e-12, 1.47892e-09, 3.82289e-08, 3.58862e-07, 1.93382e-06, 7.33565e-06, 2.18396e-05, 5.4455e-05, 0.00011858, 0.000232054, 0.000416514, 0.000696104, 0.001095698, 0.001638861, 0.002345789, 0.00323146, 0.004304181, 0.00556463, 0.00700546, 0.008611455, 0.010360183, 0.012223046, 0.014166634, 0.016154253, 0.018147516, 0.020107905, 0.021998208, 0.023783782, 0.025433582, 0.026920954, 0.028224167, 0.029326706, 0.030217343, 0.030890005, 0.031343492, 0.031581054, 0.03160988, 0.03144053, 0.031086331, 0.030562767, 0.029886897, 0.02907679, 0.028151024, 0.027128226, 0.026026688, 0.024864032, 0.023656947, 0.022420984, 0.021170408, 0.019918098, 0.018675501, 0.017452611, 0.016257997, 0.015098848, 0.013981041, 0.01290923, 0.011886937, 0.010916662, 0.009999984, 0.009137674, 0.008329797, 0.007575814, 0.006874678, 0.006224928, 0.005624764, 0.005072128, 0.004564767, 0.004100293, 0.003676235, 0.003290085, 0.002939333, 0.002621497, 0.002334153, 0.002074954, 0.001841643, 0.001632068, 0.001444191, 0.001276089, 0.001125961, 0.000992126],
    "CDF": [0.0, 4.81974e-12, 1.48374e-09, 3.97126e-08, 3.98575e-07, 2.3324e-06, 9.66805e-06, 3.15076e-05, 8.59626e-05, 0.000204543, 0.000436597, 0.000853111, 0.001549215, 0.002644913, 0.004283775, 0.006629563, 0.009861023, 0.014165204, 0.019729835, 0.026735294, 0.035346749, 0.045706932, 0.057929978, 0.072096612, 0.088250865, 0.106398382, 0.126506286, 0.148504494, 0.172288276, 0.197721858, 0.224642813, 0.25286698, 0.282193686, 0.312411029, 0.343301034, 0.374644527, 0.406225581, 0.437835461, 0.469275991, 0.500362322, 0.530925089, 0.560811986, 0.589888776, 0.6180398, 0.645168027, 0.671194715, 0.696058747, 0.719715694, 0.742136677, 0.763307085, 0.783225183, 0.801900684, 0.819353295, 0.835611293, 0.85071014, 0.864691182, 0.877600411, 0.889487348, 0.90040401, 0.910403994, 0.919541669, 0.927871466, 0.935447279, 0.942321957, 0.948546885, 0.95417165, 0.959243778, 0.963808545, 0.967908837, 0.971585073, 0.974875158, 0.977814491, 0.980435987, 0.98277014, 0.984845094, 0.986686737, 0.988318805, 0.989762996, 0.991039085, 0.992165046, 0.993157172],
}

const gammaFit_tbl = makeTbl(gameLenGammaFit);
gammaFit_tbl.setAttribute('class', 'resultsTable')
const gamma_div = document.getElementById('gamma-tbl');
gamma_div.appendChild(gammaFit_tbl)

const gamma_exp_btn = document.getElementById('exp_btn2');

function expand2(){
    expand(1)
    return 
}

gamma_exp_btn.addEventListener('click', expand2, false)

// gamma fit graph
// create new data and concat this to the old list
const gammaPDF_data = [{
    x: gameLenGammaFit['Tiles Used'],
    y: [0.0, 1.92789e-07, 5.91567e-05, 0.001529156, 0.014354496, 0.077352965, 0.293425999, 0.873582432, 2.17819895, 4.743207743, 9.282169056, 16.66055541, 27.84415276, 43.82793718, 65.55445579, 93.83154046, 129.2584007, 172.1672569, 222.5852025, 280.2183827, 344.4581983, 414.4073089, 488.921838, 566.6653784, 646.1701283, 725.9006444, 804.3161866, 879.928323, 951.3512729, 1017.34329, 1076.838173, 1128.966688, 1173.068257, 1208.693708, 1235.600212, 1253.739699, 1263.242161, 1264.395208, 1257.621212, 1243.453223, 1222.510692, 1195.475878, 1163.071613, 1126.040952, 1085.12906, 1041.067535, 994.5612782, 946.2778648, 896.8393461, 846.8163001, 796.7239399, 747.0200407, 698.1044441, 650.3198868, 603.9539135, 559.2416441, 516.3691827, 475.4774783, 436.6664701, 399.9993723, 365.5069774, 333.1918797, 303.03254, 274.9871314, 248.9971238, 224.9905774, 202.88513, 182.5906708, 164.0117034, 147.0494075, 131.6034128, 117.573302, 104.8598651, 93.3661243, 82.99815394, 73.66571648, 65.28273707, 57.76763744, 51.04354889, 45.03842271, 39.68505482],
    name: 'Fitted PDF',
    type: 'scatter'
}];

Plotly.newPlot('gamma-fit-graph', gameLenArrData.concat(gammaPDF_data), gameLenLayout);

const CDF_data = [
    {
        x: [4.0, 6.0, 7.0, 8.0, 9.0, 10.0, 11.0, 12.0, 13.0, 14.0, 15.0, 16.0, 17.0, 18.0, 19.0, 20.0, 21.0, 22.0, 23.0, 24.0, 25.0, 26.0, 27.0, 28.0, 29.0, 30.0, 31.0, 32.0, 33.0, 34.0, 35.0, 36.0, 37.0, 38.0, 39.0, 40.0, 41.0, 42.0, 43.0, 44.0, 45.0, 46.0, 47.0, 48.0, 49.0, 50.0, 51.0, 52.0, 53.0, 54.0, 55.0, 56.0, 57.0, 58.0, 59.0, 60.0, 61.0, 62.0, 63.0, 64.0, 65.0, 66.0, 67.0, 68.0, 69.0, 70.0, 71.0, 72.0, 73.0, 74.0, 75.0, 76.0, 77.0, 78.0, 79.0, 80.0],
        y: [2.5e-05, 5e-05, 7.5e-05, 0.00015, 0.000275, 0.000525, 0.00095, 0.0016, 0.0025, 0.00405, 0.006, 0.0088, 0.012275, 0.01775, 0.024525, 0.031725, 0.04225, 0.054025, 0.066725, 0.082175, 0.099425, 0.118425, 0.140825, 0.163425, 0.187925, 0.214375, 0.2429, 0.27295, 0.303175, 0.3328, 0.363775, 0.394475, 0.426425, 0.457525, 0.489175, 0.52065, 0.5495, 0.579175, 0.6057, 0.633625, 0.659925, 0.685075, 0.708325, 0.72895, 0.750875, 0.770775, 0.7884, 0.80655, 0.82355, 0.837875, 0.8527, 0.865075, 0.877825, 0.8878, 0.8985, 0.9078, 0.91585, 0.923525, 0.930825, 0.937225, 0.943225, 0.949, 0.9544, 0.959125, 0.963075, 0.9662, 0.9694, 0.9726, 0.9753, 0.978025, 0.979875, 0.98205, 0.9839, 0.9855, 0.986525, 0.987625],
        name: 'Raw data',
        mode: 'markers',
        type: 'scatter'
    },
    {
        x: [0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0, 11.0, 12.0, 13.0, 14.0, 15.0, 16.0, 17.0, 18.0, 19.0, 20.0, 21.0, 22.0, 23.0, 24.0, 25.0, 26.0, 27.0, 28.0, 29.0, 30.0, 31.0, 32.0, 33.0, 34.0, 35.0, 36.0, 37.0, 38.0, 39.0, 40.0, 41.0, 42.0, 43.0, 44.0, 45.0, 46.0, 47.0, 48.0, 49.0, 50.0, 51.0, 52.0, 53.0, 54.0, 55.0, 56.0, 57.0, 58.0, 59.0, 60.0, 61.0, 62.0, 63.0, 64.0, 65.0, 66.0, 67.0, 68.0, 69.0, 70.0, 71.0, 72.0, 73.0, 74.0, 75.0, 76.0, 77.0, 78.0, 79.0, 80.0],
        y: [0.0, 4.81974e-12, 1.48374e-09, 3.97126e-08, 3.98575e-07, 2.3324e-06, 9.66805e-06, 3.15076e-05, 8.59626e-05, 0.000204543, 0.000436597, 0.000853111, 0.001549215, 0.002644913, 0.004283775, 0.006629563, 0.009861023, 0.014165204, 0.019729835, 0.026735294, 0.035346749, 0.045706932, 0.057929978, 0.072096612, 0.088250865, 0.106398382, 0.126506286, 0.148504494, 0.172288276, 0.197721858, 0.224642813, 0.25286698, 0.282193686, 0.312411029, 0.343301034, 0.374644527, 0.406225581, 0.437835461, 0.469275991, 0.500362322, 0.530925089, 0.560811986, 0.589888776, 0.6180398, 0.645168027, 0.671194715, 0.696058747, 0.719715694, 0.742136677, 0.763307085, 0.783225183, 0.801900684, 0.819353295, 0.835611293, 0.85071014, 0.864691182, 0.877600411, 0.889487348, 0.90040401, 0.910403994, 0.919541669, 0.927871466, 0.935447279, 0.942321957, 0.948546885, 0.95417165, 0.959243778, 0.963808545, 0.967908837, 0.971585073, 0.974875158, 0.977814491, 0.980435987, 0.98277014, 0.984845094, 0.986686737, 0.988318805, 0.989762996, 0.991039085, 0.992165046, 0.993157172],
        name: 'Fitted CDF',
        type: 'scatter'
    }
];

const CDFLayout = {
    xaxis: {range: [0, 84], title: "Tiles Used"},
    yaxis: {range: [0, 1], title: "Cumlative Occurences Proportion"},
    title: "Cumalative wins against Tiles Used",
    font: {
        family: "Ubuntu, monospace",
        size: 16,
    }
};

Plotly.newPlot('cdf-fit-graph', CDF_data, CDFLayout);


// score tables
const scoringDB = {
    "score": [7.0, 8.0, 9.0, 10.0, 11.0, 12.0, 13.0, 14.0, 15.0, 16.0, 17.0, 18.0, 19.0, 20.0, 21.0, 22.0, 23.0, 24.0, 25.0, 26.0, 27.0, 28.0, 29.0, 30.0, 31.0, 32.0, 33.0, 34.0, 35.0, 36.0, 37.0, 38.0, 39.0, 40.0, 41.0, 42.0, 43.0, 44.0, 45.0, 46.0, 47.0, 48.0, 49.0, 50.0, 51.0, 52.0, 53.0, 54.0, 55.0, 56.0, 57.0, 58.0, 59.0, 60.0, 61.0, 62.0, 63.0, 64.0, 65.0, 66.0, 67.0, 68.0, 69.0, 70.0, 71.0, 72.0, 73.0, 74.0, 75.0, 76.0, 78.0, 79.0, 80.0, 81.0, 82.0, 85.0, 86.0, 88.0, 89.0, 91.0, 94.0, 100.0, 103.0, 107.0, 116.0, 121.0, 122.0, 127.0, 129.0, 143.0, 152.0, 160.0, 163.0, 170.0],
    "occurences": [499.0, 787.0, 1485.0, 2089.0, 2405.0, 2883.0, 2801.0, 2719.0, 2523.0, 2103.0, 2033.0, 1709.0, 1571.0, 1497.0, 1238.0, 1241.0, 990.0, 880.0, 900.0, 681.0, 666.0, 577.0, 527.0, 537.0, 362.0, 369.0, 308.0, 222.0, 314.0, 143.0, 163.0, 113.0, 116.0, 84.0, 78.0, 72.0, 66.0, 59.0, 75.0, 25.0, 43.0, 114.0, 112.0, 127.0, 76.0, 80.0, 62.0, 61.0, 61.0, 87.0, 72.0, 145.0, 97.0, 97.0, 75.0, 57.0, 21.0, 22.0, 22.0, 29.0, 22.0, 23.0, 23.0, 12.0, 8.0, 3.0, 4.0, 5.0, 2.0, 1.0, 3.0, 2.0, 2.0, 3.0, 1.0, 1.0, 1.0, 1.0, 2.0, 2.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0],
}

const score_tbl = makeTbl(scoringDB);
score_tbl.setAttribute('class', 'resultsTable');
const score_div = document.getElementById('score-tbl');

score_div.appendChild(score_tbl);

// score expand button
const score_btn = document.getElementById('exp_btn3');
function expand3(){
    expand(2)
    return
}

score_btn.addEventListener("click", expand3, false);

const scoreData = [{
    x: scoringDB['score'],
    y: scoringDB['occurences'],
    mode: 'markers',
    type: 'scatter',
}];

const scoreLayout = {
    xaxis: {range: [0, 180], title: "Score"},
    yaxis: {range: [0, 3000], title: "Occurences"},
    title: "Occurences of different scores",
    font: {
        family: "Ubuntu, monospace",
        size: 16,
    }
};

Plotly.newPlot('score-graph', scoreData, scoreLayout);

const scoreCumData = [{
    x: [7.0, 8.0, 9.0, 10.0, 11.0, 12.0, 13.0, 14.0, 15.0, 16.0, 17.0, 18.0, 19.0, 20.0, 21.0, 22.0, 23.0, 24.0, 25.0, 26.0, 27.0, 28.0, 29.0, 30.0, 31.0, 32.0, 33.0, 34.0, 35.0, 36.0, 37.0, 38.0, 39.0, 40.0, 41.0, 42.0, 43.0, 44.0, 45.0, 46.0, 47.0, 48.0, 49.0, 50.0, 51.0, 52.0, 53.0, 54.0, 55.0, 56.0, 57.0, 58.0, 59.0, 60.0, 61.0, 62.0, 63.0, 64.0, 65.0, 66.0, 67.0, 68.0, 69.0, 70.0, 71.0, 72.0, 73.0, 74.0, 75.0, 76.0, 78.0, 79.0, 80.0, 81.0, 82.0, 85.0, 86.0, 88.0, 89.0, 91.0, 94.0, 100.0, 103.0, 107.0, 116.0, 121.0, 122.0, 127.0, 129.0, 143.0, 152.0, 160.0, 163.0, 170.0],
    y: [499.0, 1286.0, 2771.0, 4860.0, 7265.0, 10148.0, 12949.0, 15668.0, 18191.0, 20294.0, 22327.0, 24036.0, 25607.0, 27104.0, 28342.0, 29583.0, 30573.0, 31453.0, 32353.0, 33034.0, 33700.0, 34277.0, 34804.0, 35341.0, 35703.0, 36072.0, 36380.0, 36602.0, 36916.0, 37059.0, 37222.0, 37335.0, 37451.0, 37535.0, 37613.0, 37685.0, 37751.0, 37810.0, 37885.0, 37910.0, 37953.0, 38067.0, 38179.0, 38306.0, 38382.0, 38462.0, 38524.0, 38585.0, 38646.0, 38733.0, 38805.0, 38950.0, 39047.0, 39144.0, 39219.0, 39276.0, 39297.0, 39319.0, 39341.0, 39370.0, 39392.0, 39415.0, 39438.0, 39450.0, 39458.0, 39461.0, 39465.0, 39470.0, 39472.0, 39473.0, 39476.0, 39478.0, 39480.0, 39483.0, 39484.0, 39485.0, 39486.0, 39487.0, 39489.0, 39491.0, 39492.0, 39493.0, 39494.0, 39495.0, 39496.0, 39497.0, 39498.0, 39499.0, 39500.0, 39501.0, 39502.0, 39503.0, 39504.0, 39505.0],
    mode: 'markers',
    type: 'scatter',
    marker: {color: 'rgb(176, 116, 176)',}
}];

const scoreCumLayout = {
    xaxis: {range: [0, 180], title: "Score"},
    yaxis: {range: [0, 40500], title: "Cumalative Occurences"},
    title: "Cumaltive Occurences of scores",
    font: {
        family: "Ubuntu, monospace",
        size: 16,
    }
};

Plotly.newPlot('score-cum-graph', scoreCumData, scoreCumLayout);

// high scoring hands
genTable([12, 12, 18, 18, 26, 26, 26, 28, 28, 28, 32, 32, 32, 36, 36, 36], '170hand')
genTable([18], '170handw')

genTable([13, 13, 16, 16, 19, 19, 22, 22, 27, 27, 27, 34, 34, 35, 35, 38], '129hand')
genTable([38], '129handw')

genTable([45, 45, 45, 46, 46, 46, 41, 41, 41], '122hando')
genTable([15, 16, 17, 18, 47, 47, 47], '122hand')
genTable([15], '122handw')

genTable([19, 19, 19, 19, 39, 39, 41, 41, 42, 42, 44, 44, 45, 45, 46, 46], '164hand')
genTable([45], '164handw')

genTable([13, 14, 15, 16, 17, 18, 25, 26, 26, 26, 32, 33, 34, 35, 36, 37], '91hand')
genTable([24], '91handw')

// bottom nav bar
fillInNavFooter('Game distrubution');